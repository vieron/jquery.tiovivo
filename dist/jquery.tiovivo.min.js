/*! jquery tiovivo - v0.1.0 - 2012-05-16
* https://github.com/vieron/jquery.tiovivo
* Copyright (c) 2012 vieron; Licensed MIT, GPL */
(function(a,b,c,d){function g(b,c){this.options=a.extend(e,c),this.element=a(b),this.donut=this.element.find("> ul"),this.theta=0,this.thetas=0,this.index=1,this.round=0,this.init()}var e={panelMargin:20},f=Modernizr.prefixed("transform"),h=g.prototype;h.init=function(){this.distributePanes(),this.goTo(1),this.initEvents()},h.initEvents=function(){this.donut.on("click","li",a.proxy(this.onClickPanel,this))},h.onClickPanel=function(b){var c=a(b.target),d=this.panels.index(c)+1;d!==this.index&&this.goTo(d)},h.distributePanes=function(){var b=this;this.panels=this.donut.find("> li"),this.panelsCount=this.panels.length,this.panelsAngle=360/this.panelsCount,this.panelSize=this.panels.width()+this.options.panelMargin,this.tz=Math.round(this.panelSize/2/Math.tan(Math.PI/this.panelsCount)),this.panels.each(function(c){a(this).css(f,"rotateY("+c*b.panelsAngle+"deg) translateZ("+b.tz+"px) scale(1)")})},h.navHandler=function(a){return this.index=a,a<=0?this.index=this.panelsCount:a>this.panelsCount&&(this.index=1),this.index},h.unActivePanel=function(a){this.panels.eq(a).css(f,"rotateY("+this.panelsAngle*a+"deg) translateZ("+this.tz+"px) scale(1)").removeClass("active")},h.activePanel=function(a){this.panels.eq(a).css(f,"rotateY("+this.panelsAngle*a+"deg) translateZ("+(this.tz+100)+"px) scale(1.2)").addClass("active")},h.roundsFromAngle=function(a){a=Math.abs(a);var b=Math.floor(a/360);return b},h.next=function(){this.goTo(this.index+1)},h.prev=function(){this.goTo(this.index-1)},h.goTo=function(a){var b,c,d,e,g=a-1,h=a-this.index;this.unActivePanel(this.index-1),a=this.navHandler(a),g=a-1,b=this.round,c=h*this.panelsAngle,d=this.theta-c,e=this.roundsFromAngle(d),this.round=e,this.theta=d,this.donut.css(f,"rotateY("+this.theta+"deg)"),this.activePanel(g)},h.addPanel=function(b){b||(b=1);var c=this.panels.eq(b-1),d=b*1+1;a("<li>"+d+"</li>").insertAfter(c),this.distributePanes()},h.removePanel=function(a){a||(a=1);var b=this.panels.eq(a-1);b.remove(),this.distributePanes()},a.fn.tiovivo=function(b){return this.each(function(){a(this).data("tiovivo")||a(this).data("tiovivo",new g(this,b))})}})(jQuery,window,document);